(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ab8addd6"],{"2ab7":function(t,e,r){"use strict";var s=r("ea0c"),a=r.n(s);a.a},"542f":function(t,e,r){"use strict";r.r(e);var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("q-page",[r("div",{staticClass:"row"},[t.$q.screen.gt.sm?r("div",{staticClass:"col-2"}):t._e(),r("div",{class:t.$q.screen.gt.sm?"col-8":"col-12"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-12 q-pa-md"},[r("div",{staticClass:"row text-h5"},[t._v(" Orders: ")]),r("div",{staticClass:"row"},[r("q-card",{staticClass:" bg-grey-1",staticStyle:{width:"100%"}},[r("div",{staticClass:"column"},[r("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},t._l(t.tempCurrentOrders,(function(e,s){return r("q-expansion-item",{key:s,attrs:{"expand-separator":""},scopedSlots:t._u([{key:"header",fn:function(){return[r("q-item-section",{attrs:{avatar:""}},[r("q-avatar",{attrs:{icon:e.icon,color:e.color,"text-color":"white"}})],1),r("q-item-section",[r("div",{staticClass:"text-subtitle2"},[t._v(" Order Number: #"+t._s(e.id)+" ")]),r("div",{staticClass:"text-caption"},[t._v(" Date: "+t._s(e.creation_date)+" ")]),r("div",{staticClass:"text-caption"},[t._v(" Time: "+t._s(e.creation_time)+" ")])]),r("q-item-section",{attrs:{side:""}},[r("div",{class:"text-bold text-"+e.color,attrs:{"background-color":"white"}},[t._v(" "+t._s(e.Status)+" ")])])]},proxy:!0}],null,!0)},[r("q-card",[r("q-card-section",[r("div",{staticClass:"row"},[r("div",{class:t.$q.platform.is.mobile?"Pending"==e.Status?"col-8":"col-12":"Pending"==e.Status?"col-9":"col-12"},[t._l(e.products,(function(s,a){return r("div",{key:a},[r("div",{staticClass:"row",class:{"q-mb-sm":a==e.products.length-1}},[r("div",{staticClass:"col-shrink"},[t._v(" "+t._s(s.count)+" x "+t._s(s.product.name)+" ")]),r("div",{staticClass:"col",staticStyle:{position:"relative"}},[r("div",{staticClass:"dotted-line"})]),r("div",{staticClass:"col-shrink"},[t._v(" "+t._s(s.count*s.product.price)+"EGP ")])])])})),r("div",{staticClass:"row q-mb-sm"},[r("div",{staticClass:"col",staticStyle:{position:"relative"}},[r("div",{staticClass:"dotted-line2"})])]),r("div",{staticClass:"row"},[r("div",{staticClass:"col-shrink"},[t._v(" Total Price: ")]),r("div",{staticClass:"col",staticStyle:{position:"relative"}},[r("div",{staticClass:"dotted-line"})]),r("div",{staticClass:"col-shrink"},[t._v(" "+t._s(e.totalPrice)+" EGP ")])])],2),"Pending"==e.Status?r("div",{class:t.$q.platform.is.mobile?"col-4":"col-3"},[r("div",{staticClass:"column justify-end"},[r("div",{staticClass:"col-12 q-my-sm"},[r("div",{staticClass:"row justify-center"},[r("q-btn",{attrs:{color:"green-6",label:"Pay Order",size:t.$q.platform.is.mobile?"sm":"md",dense:t.$q.platform.is.mobile},on:{click:function(r){return t.payOrderClicked(e)}}})],1)]),r("div",{staticClass:"col-12"},[r("div",{staticClass:"row justify-center"},[r("q-btn",{attrs:{color:"red-8",label:"Cancel Order",dense:t.$q.platform.is.mobile,size:t.$q.platform.is.mobile?"sm":"md"},on:{click:function(r){return t.cancelOrderClicked(e)}}})],1)])])]):t._e()])])],1)],1)})),1)],1)])],1)])])]),r("q-dialog",{attrs:{persistent:""},model:{value:t.showPay,callback:function(e){t.showPay=e},expression:"showPay"}},[r("q-card",{staticStyle:{width:"300px"}},[r("q-card-section",{staticClass:"row items-center"},[r("PaymentCard",{attrs:{currentOrder:this.selectedOrder},on:{orderPaymentSuccess:t.paymentCardAction}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"cancel",color:"primary"},on:{click:t.paymentCardAction}})],1)],1)],1),r("q-dialog",{attrs:{persistent:""},model:{value:t.showCancel,callback:function(e){t.showCancel=e},expression:"showCancel"}},[r("q-card",[r("q-card-section",{staticClass:"row items-center"},[r("span",{staticClass:"q-ml-sm"},[t._v("Are you sure you want to cancel your order ?")])]),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"No",color:"primary"},on:{click:function(e){return t.cancelCardAction(1)}}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Yes",color:"primary"},on:{click:function(e){return t.cancelCardAction(2)}}})],1)],1)],1),t.$q.screen.gt.sm?r("div",{staticClass:"col-2"}):t._e()],1)])},a=[],c=(r("4160"),r("159b"),r("96cf"),r("1da1")),i=r("c151"),n=r("d80e"),o={name:"MyOrders",components:{PaymentCard:n["a"]},data:function(){return{totalPrice:0,showPay:!1,showCancel:!1,createdOrderId:null,currentOrders:[],tempCurrentOrders:[],selectedOrder:null}},methods:{cancelOrderClicked:function(t){this.selectedOrder=t,this.showCancel=!0},payOrderClicked:function(t){this.selectedOrder=t,this.showPay=!0},paymentCardAction:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getMyOrders();case 2:t.showPay=!1,t.selectedOrder=null;case 4:case"end":return e.stop()}}),e)})))()},cancelCardAction:function(t){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(2!=t){r.next=5;break}return r.next=3,e.$store.dispatch("cancelOrder",e.selectedOrder.id).then((function(t){e.$q.notify({type:t.status&&"success"==t.status?"positive":"negative",message:t.message?t.message:"Error Occured",timeout:2e3})}));case 3:return r.next=5,e.getMyOrders();case 5:e.showCancel=!1,e.selectedOrder=null;case 7:case"end":return r.stop()}}),r)})))()},getMyOrders:function(){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(i["a"])().get("/orders/getCustomerOrders").then((function(e){if("success"==e.data.status){var r=e.data.data;r.forEach((function(t){var e=t.created_at,r=e.substring(0,10);t.creation_date=r;var s=e.substring(11,19);t.creation_time=s,t.paid||t.cancelled||(t.Status="Pending",t.color="yellow",t.icon="receipt"),!t.paid&&t.cancelled&&(t.Status="Cancelled",t.color="red",t.icon="close"),t.paid&&!t.cancelled&&(t.Status="Paid",t.color="green",t.icon="check"),t.totalPrice=0,t.products.forEach((function(e){t.totalPrice+=e.count*e.product.price}))})),t.tempCurrentOrders=r,t.currentOrders=r}}));case 2:case"end":return e.stop()}}),e)})))()}},computed:{currentCart:function(){return this.$store.getters.getCart}},created:function(){this.getMyOrders()}},l=o,d=(r("2ab7"),r("2877")),u=Object(d["a"])(l,s,a,!1,null,"42d7c89c",null);e["default"]=u.exports},"54ec":function(t,e,r){},d80e:function(t,e,r){"use strict";var s=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticStyle:{width:"100%"}},[r("div",{ref:"card"}),r("div",{staticClass:"q-mb-lg"},[t._v("Payment Card")]),r("div",{attrs:{id:"card-element"}}),r("div",[r("button",{staticClass:"payment-button",on:{click:t.submit}},[t._v("Pay")])])])},a=[],c=(r("96cf"),r("1da1")),i={props:{currentOrder:{required:!0,default:""}},data:function(){return{stripeAPIToken:"pk_test_bB4E6BT0ma0UOr8GvpseWiYH00iAF9YnLp",stripe:"",elements:"",card:""}},methods:{configureStripe:function(){this.stripe=Stripe(this.stripeAPIToken),this.elements=this.stripe.elements();var t={base:{color:"#32325d",paddingTop:"15px"}};this.card=this.elements.create("card",{style:t}),this.card.mount("#card-element")},includeStripe:function(t,e){var r=document,s="script",a=r.createElement(s),c=r.getElementsByTagName(s)[0];a.src="//"+t,e&&a.addEventListener("load",(function(t){e(null,t)}),!1),c.parentNode.insertBefore(a,c)},submit:function(t){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.preventDefault(),s=e.currentOrder.payment_intent,a=e.$store.getters.getCustomerName,e.$q.loading.show(),r.next=6,e.stripe.confirmCardPayment(s,{payment_method:{card:e.card,billing_details:{name:a}}}).then((function(t){e.$q.loading.hide()})).catch((function(t){e.$q.loading.hide()}));case 6:return r.next=8,e.$store.dispatch("payOrder",{order_id:e.currentOrder.id}).then((function(t){e.$q.notify({type:t.status&&"success"==t.status?"positive":"negative",message:t.message?t.message:"Error Occured",timeout:2e3}),e.$emit("orderPaymentSuccess")}));case 8:case"end":return r.stop()}}),r)})))()}},created:function(){this.includeStripe("js.stripe.com/v3/",function(){this.configureStripe()}.bind(this))}},n=i,o=(r("ed9f"),r("2877")),l=Object(o["a"])(n,s,a,!1,null,"23cfe2ae",null);e["a"]=l.exports},ea0c:function(t,e,r){},ed9f:function(t,e,r){"use strict";var s=r("54ec"),a=r.n(s);a.a}}]);
//# sourceMappingURL=chunk-ab8addd6.c60c2c00.js.map