(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-025bc933"],{"0eb4":function(e,t,r){},"2ab7":function(e,t,r){"use strict";var s=r("ea0c"),a=r.n(s);a.a},"542f":function(e,t,r){"use strict";r.r(t);var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("q-page",[r("div",{staticClass:"row"},[e.$q.screen.gt.sm?r("div",{staticClass:"col-2"}):e._e(),r("div",{class:e.$q.screen.gt.sm?"col-8":"col-12"},[r("div",{staticClass:"row"},[r("div",{staticClass:"col-12 q-pa-md"},[r("div",{staticClass:"row text-h5"},[e._v(" Orders: ")]),r("div",{staticClass:"row"},[r("q-card",{staticClass:" bg-grey-1",staticStyle:{width:"100%"}},[r("div",{staticClass:"column"},[r("q-list",{staticClass:"rounded-borders",attrs:{bordered:""}},e._l(e.tempCurrentOrders,(function(t,s){return r("q-expansion-item",{key:s,attrs:{"expand-separator":""},scopedSlots:e._u([{key:"header",fn:function(){return[r("q-item-section",{attrs:{avatar:""}},[r("q-avatar",{attrs:{icon:t.icon,color:t.color,"text-color":"white"}})],1),r("q-item-section",[r("div",{staticClass:"text-subtitle2"},[e._v(" Order Number: #"+e._s(t.id)+" ")]),r("div",{staticClass:"text-caption"},[e._v(" Date: "+e._s(t.creation_date)+" ")]),r("div",{staticClass:"text-caption"},[e._v(" Time: "+e._s(t.creation_time)+" ")])]),r("q-item-section",{attrs:{side:""}},[r("div",{class:"text-bold text-"+t.color,attrs:{"background-color":"white"}},[e._v(" "+e._s(t.Status)+" ")])])]},proxy:!0}],null,!0)},[r("q-card",[r("q-card-section",[r("div",{staticClass:"row"},[r("div",{class:e.$q.platform.is.mobile?"Pending"==t.Status?"col-8":"col-12":"Pending"==t.Status?"col-9":"col-12"},[e._l(t.products,(function(s,a){return r("div",{key:a},[r("div",{staticClass:"row",class:{"q-mb-sm":a==t.products.length-1}},[r("div",{staticClass:"col-shrink"},[e._v(" "+e._s(s.count)+" x "+e._s(s.product.name)+" ")]),r("div",{staticClass:"col",staticStyle:{position:"relative"}},[r("div",{staticClass:"dotted-line"})]),r("div",{staticClass:"col-shrink"},[e._v(" "+e._s(s.count*s.product.price)+"EGP ")])])])})),r("div",{staticClass:"row q-mb-sm"},[r("div",{staticClass:"col",staticStyle:{position:"relative"}},[r("div",{staticClass:"dotted-line2"})])]),r("div",{staticClass:"row"},[r("div",{staticClass:"col-shrink"},[e._v(" Total Price: ")]),r("div",{staticClass:"col",staticStyle:{position:"relative"}},[r("div",{staticClass:"dotted-line"})]),r("div",{staticClass:"col-shrink"},[e._v(" "+e._s(t.totalPrice)+" EGP ")])])],2),"Pending"==t.Status?r("div",{class:e.$q.platform.is.mobile?"col-4":"col-3"},[r("div",{staticClass:"column justify-end"},[r("div",{staticClass:"col-12 q-my-sm"},[r("div",{staticClass:"row justify-center"},[r("q-btn",{attrs:{color:"green-6",label:"Pay Order",size:e.$q.platform.is.mobile?"sm":"md",dense:e.$q.platform.is.mobile},on:{click:function(r){return e.payOrderClicked(t)}}})],1)]),r("div",{staticClass:"col-12"},[r("div",{staticClass:"row justify-center"},[r("q-btn",{attrs:{color:"red-8",label:"Cancel Order",dense:e.$q.platform.is.mobile,size:e.$q.platform.is.mobile?"sm":"md"},on:{click:function(r){return e.cancelOrderClicked(t)}}})],1)])])]):e._e()])])],1)],1)})),1)],1)])],1)])])]),r("q-dialog",{attrs:{persistent:""},model:{value:e.showPay,callback:function(t){e.showPay=t},expression:"showPay"}},[r("q-card",{staticStyle:{width:"300px"}},[r("q-card-section",{staticClass:"row items-center"},[r("PaymentCard",{attrs:{currentOrder:this.selectedOrder},on:{orderPaymentSuccess:e.paymentCardAction}})],1),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"cancel",color:"primary"},on:{click:e.paymentCardAction}})],1)],1)],1),r("q-dialog",{attrs:{persistent:""},model:{value:e.showCancel,callback:function(t){e.showCancel=t},expression:"showCancel"}},[r("q-card",[r("q-card-section",{staticClass:"row items-center"},[r("span",{staticClass:"q-ml-sm"},[e._v("Are you sure you want to cancel your order ?")])]),r("q-card-actions",{attrs:{align:"right"}},[r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"No",color:"primary"},on:{click:function(t){return e.cancelCardAction(1)}}}),r("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Yes",color:"primary"},on:{click:function(t){return e.cancelCardAction(2)}}})],1)],1)],1),e.$q.screen.gt.sm?r("div",{staticClass:"col-2"}):e._e()],1)])},a=[],c=(r("4160"),r("159b"),r("96cf"),r("1da1")),n=r("c151"),i=r("d80e"),o={name:"MyOrders",components:{PaymentCard:i["a"]},data:function(){return{totalPrice:0,showPay:!1,showCancel:!1,createdOrderId:null,currentOrders:[],tempCurrentOrders:[],selectedOrder:null}},methods:{cancelOrderClicked:function(e){this.selectedOrder=e,this.showCancel=!0},payOrderClicked:function(e){this.selectedOrder=e,this.showPay=!0},paymentCardAction:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.getMyOrders();case 2:e.showPay=!1,e.selectedOrder=null;case 4:case"end":return t.stop()}}),t)})))()},cancelCardAction:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(2!=e){r.next=5;break}return r.next=3,t.$store.dispatch("cancelOrder",t.selectedOrder.id).then((function(e){t.$q.notify({type:e.status&&"success"==e.status?"positive":"negative",message:e.message?e.message:"Error Occured",timeout:2e3})}));case 3:return r.next=5,t.getMyOrders();case 5:t.showCancel=!1,t.selectedOrder=null;case 7:case"end":return r.stop()}}),r)})))()},getMyOrders:function(){var e=this;return Object(c["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(n["a"])().get("/orders/getCustomerOrders").then((function(t){if("success"==t.data.status){var r=t.data.data;r.forEach((function(e){var t=e.created_at,r=t.substring(0,10);e.creation_date=r;var s=t.substring(11,19);e.creation_time=s,e.paid||e.cancelled||(e.Status="Pending",e.color="yellow",e.icon="receipt"),!e.paid&&e.cancelled&&(e.Status="Cancelled",e.color="red",e.icon="close"),e.paid&&!e.cancelled&&(e.Status="Paid",e.color="green",e.icon="check"),e.totalPrice=0,e.products.forEach((function(t){e.totalPrice+=t.count*t.product.price}))})),e.tempCurrentOrders=r,e.currentOrders=r}}));case 2:case"end":return t.stop()}}),t)})))()}},computed:{currentCart:function(){return this.$store.getters.getCart}},created:function(){this.getMyOrders()}},l=o,d=(r("2ab7"),r("2877")),u=Object(d["a"])(l,s,a,!1,null,"42d7c89c",null);t["default"]=u.exports},ce75:function(e,t,r){"use strict";var s=r("0eb4"),a=r.n(s);a.a},d80e:function(e,t,r){"use strict";var s=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticStyle:{width:"100%"}},[r("div",{ref:"card"}),r("div",{staticClass:"q-mb-lg"},[e._v("Payment Card")]),r("div",{attrs:{id:"card-element"}}),r("div",[r("button",{staticClass:"payment-button",on:{click:e.submit}},[e._v("Pay")])])])},a=[],c=(r("96cf"),r("1da1")),n={props:{currentOrder:{required:!0,default:""}},data:function(){return{stripeAPIToken:"pk_test_bB4E6BT0ma0UOr8GvpseWiYH00iAF9YnLp",stripe:"",elements:"",card:""}},methods:{configureStripe:function(){this.stripe=Stripe(this.stripeAPIToken),this.elements=this.stripe.elements();var e={base:{color:"#32325d",paddingTop:"15px"}};this.card=this.elements.create("card",{style:e}),this.card.mount("#card-element")},includeStripe:function(e,t){var r=document,s="script",a=r.createElement(s),c=r.getElementsByTagName(s)[0];a.src="//"+e,t&&a.addEventListener("load",(function(e){t(null,e)}),!1),c.parentNode.insertBefore(a,c)},submit:function(e){var t=this;return Object(c["a"])(regeneratorRuntime.mark((function r(){var s,a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(e.preventDefault(),console.log("this.card",t.card),!t.card._empty){r.next=5;break}return t.$q.notify({type:"negative",message:"Please fill your credit card number",timeout:2e3}),r.abrupt("return");case 5:if(!t.card._invalid){r.next=8;break}return t.$q.notify({type:"negative",message:"Please fill your credit card data correctly",timeout:2e3}),r.abrupt("return");case 8:return s=t.currentOrder.payment_intent,a=t.$store.getters.getCustomerName,t.$q.loading.show(),r.next=13,t.$store.dispatch("payOrder",{order_id:t.currentOrder.id}).then(function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(r){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!r.status||"success"!=r.status){e.next=6;break}return t.$q.loading.show(),e.next=4,t.stripe.confirmCardPayment(s,{payment_method:{card:t.card,billing_details:{name:a}}}).then((function(e){t.$q.loading.hide(),t.$q.notify({type:r.status&&"success"==r.status?"positive":"negative",message:r.message?r.message:"Error Occured",timeout:2e3}),t.$emit("orderPaymentSuccess"),console.log("re1s",e)})).catch((function(e){t.$q.loading.hide(),t.$q.notify({type:r.status&&"success"==r.status?"positive":"negative",message:r.message?r.message:"Error Occured",timeout:2e3}),t.$emit("orderPaymentSuccess"),console.log("er1r",e)}));case 4:e.next=8;break;case 6:t.$q.notify({type:r.status&&"success"==r.status?"positive":"negative",message:r.message?r.message:"Error Occured",timeout:2e3}),t.$emit("orderPaymentSuccess");case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 13:case"end":return r.stop()}}),r)})))()}},created:function(){this.includeStripe("js.stripe.com/v3/",function(){this.configureStripe()}.bind(this))}},i=n,o=(r("ce75"),r("2877")),l=Object(o["a"])(i,s,a,!1,null,"7e01de10",null);t["a"]=l.exports},ea0c:function(e,t,r){}}]);
//# sourceMappingURL=chunk-025bc933.fab2c3a6.js.map