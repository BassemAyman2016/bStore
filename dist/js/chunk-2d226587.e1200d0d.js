(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d226587"],{e7ed:function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"row"},[e.$q.screen.gt.sm?s("div",{staticClass:"col-2"}):e._e(),s("div",{staticClass:" q-pa-md",class:e.$q.screen.gt.sm?"col-8":"col-12"},[s("div",{staticClass:"row justify-center"},[s("div",{class:e.$q.screen.gt.sm?"col-8":"col-12"},[s("div",{staticClass:"row text-h5 q-mb-md"},[e._v(" Edit Product ")]),s("div",[s("q-card",{staticClass:" bg-grey-1 row q-mb-sm",staticStyle:{width:"100%"}},[s("div",{staticClass:"col-12"},[s("q-card-section",{staticClass:" col-12 "},[s("div",{staticClass:"row"},[s("div",{staticClass:"col  "},[s("q-input",{attrs:{"bg-color":"white",outlined:"",label:"Product Name"},model:{value:e.selectedProduct.name,callback:function(t){e.$set(e.selectedProduct,"name",t)},expression:"selectedProduct.name"}})],1)])]),s("q-card-section",{staticClass:" col-12 "},[s("div",{staticClass:"row"},[s("div",{staticClass:"col  "},[s("q-input",{attrs:{"bg-color":"white",outlined:"",label:"Description",type:"textarea"},model:{value:e.selectedProduct.description,callback:function(t){e.$set(e.selectedProduct,"description",t)},expression:"selectedProduct.description"}})],1)])]),s("q-card-section",{staticClass:" col-12 "},[s("div",{staticClass:"row"},[s("div",{staticClass:"col  "},[s("q-input",{attrs:{"bg-color":"white",outlined:"",label:"Price",type:"number"},model:{value:e.selectedProduct.price,callback:function(t){e.$set(e.selectedProduct,"price",t)},expression:"selectedProduct.price"}})],1)])]),s("q-card-section",{staticClass:" col-12 "},[s("div",{staticClass:"row"},[s("div",{staticClass:"col  "},[s("q-input",{attrs:{"bg-color":"white",outlined:"",label:"Stock",type:"number"},model:{value:e.selectedProduct.stock,callback:function(t){e.$set(e.selectedProduct,"stock",t)},expression:"selectedProduct.stock"}})],1)])]),s("q-card-section",{staticClass:" col-12 "},[s("div",{staticClass:"row items-center"},[s("div",{staticClass:"col-6"},[s("div",{staticClass:"column"},[s("div",{staticClass:"col q-mb-md"},[s("Dropdown",{attrs:{options:e.availableCategories,placeholder:"Category",clearData:e.dataEraser,outsideValue:e.selectedProduct.Category},on:{selected:function(t){return e.dropdownInput(t,"newCategory")}}})],1),s("div",{staticClass:"col q-mb-md"},[s("Dropdown",{attrs:{options:e.availableBrands,placeholder:"Brand",clearData:e.dataEraser,outsideValue:e.selectedProduct.Brand},on:{selected:function(t){return e.dropdownInput(t,"newBrand")}}})],1),s("div",{staticClass:"col"},[s("Dropdown",{attrs:{options:e.availableModels,placeholder:"Model",clearData:e.dataEraser,outsideValue:e.selectedProduct.Model},on:{selected:function(t){return e.dropdownInput(t,"newModel")}}})],1)])]),s("div",{staticClass:"col-5 offset-1"},[s("div",{staticClass:"row"},e._l(e.selectedProduct.images,(function(t,a){return s("div",{key:a,staticClass:"col-shrink"},[s("q-img",{staticStyle:{width:"100px"},attrs:{src:t.img,ratio:1,"spinner-color":"white"}},[s("q-btn",{attrs:{round:"",size:"xs",color:"grey",icon:"close"},on:{click:function(s){return e.removeImageClicked(t)}}})],1)],1)})),0),s("div",{staticClass:"row ",staticStyle:{"font-size":"12px"}},[s("div",{staticClass:"col-12 q-mb-sm"},[e._v(" Uploads "),s("q-toggle",{attrs:{size:"xs"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}}),e._v(" Links ")],1),s("div",{directives:[{name:"show",rawName:"v-show",value:e.value,expression:"value"}],staticClass:"col-12"},e._l(e.imageLinks,(function(t,a){return s("div",{key:t.distinctNumber,staticClass:"row justify-evenly items-center q-mb-sm"},[s("div",{staticClass:"col-9"},[s("q-input",{attrs:{"bg-color":"white",outlined:"",dense:"",label:"Link "+(a+1),type:"text"},model:{value:t.link,callback:function(s){e.$set(t,"link",s)},expression:"item.link"}})],1),s("div",{staticClass:"col-2"},0==a?[s("q-btn",{staticClass:"bg-green-14 text-white",attrs:{round:"",dense:"",size:"sm",icon:"add"},on:{click:e.addImageLink}})]:[s("q-btn",{staticClass:"bg-red-8 text-white",attrs:{round:"",dense:"",size:"sm",icon:"remove"},on:{click:function(s){return e.removeImageLink(t)}}})],1)])})),0),s("div",{directives:[{name:"show",rawName:"v-show",value:!e.value,expression:"!value"}],staticClass:"col-12"},e._l(e.imageInputs,(function(t,a){return s("div",{key:t.distinctNumber,staticClass:"row justify-evenly items-center q-mb-sm"},[s("div",{staticClass:"col-9"},[s("PictureInput",{attrs:{width:"150",height:"100",accept:"image/jpeg,image/png",size:"10",autoToggleAspectRatio:!0,zIndex:0,buttonClass:"btn",hideChangeButton:!0},on:{change:function(s){return e.imageUpload(s,t)}}})],1),s("div",{staticClass:"col-2"},0==a?[s("q-btn",{staticClass:"bg-green-14 text-white",attrs:{round:"",dense:"",size:"sm",icon:"add"},on:{click:e.addImageInput}})]:[s("q-btn",{staticClass:"bg-red-8 text-white",attrs:{round:"",dense:"",size:"sm",icon:"remove"},on:{click:function(s){return e.removeImageInput(t)}}})],1)])})),0)])])])])],1),s("div",{staticClass:"col-12"},[s("div",{staticClass:"row justify-center ",staticStyle:{height:"100%"}},[s("div",{staticClass:"col-shrink"},[s("div",{staticClass:"row"},[s("div",{staticClass:"col-shrink q-my-sm q-mx-xs"},[s("q-btn",{attrs:{dense:"",color:"green-7",label:"Edit Product",size:e.$q.platform.is.mobile?"sm":"md"},on:{click:e.updateProduct}})],1),s("div",{staticClass:"col-shrink q-my-sm q-mx-xs"},[s("q-btn",{attrs:{dense:"",color:"primary",label:"Restore Images",size:e.$q.platform.is.mobile?"sm":"md"},on:{click:e.restoreDeletedImages}})],1)])])])])])],1),s("q-dialog",{attrs:{persistent:""},model:{value:e.showImageDeleteCondition,callback:function(t){e.showImageDeleteCondition=t},expression:"showImageDeleteCondition"}},[s("q-card",[s("q-card-section",{staticClass:"row items-center"},[s("span",{staticClass:"q-ml-sm"},[e._v("Are you sure you want to delete this image ?")])]),s("q-card-actions",{attrs:{align:"right"}},[s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"No",color:"primary"},on:{click:function(t){return e.deleteCardAction(1)}}}),s("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"Yes",color:"primary"},on:{click:function(t){return e.deleteCardAction(2)}}})],1)],1)],1)],1)])]),e.$q.screen.gt.sm?s("div",{staticClass:"col-2"}):e._e()])},n=[],i=(s("a4d3"),s("e01a"),s("4160"),s("a434"),s("b0c0"),s("9911"),s("159b"),s("96cf"),s("1da1")),r=s("5bac"),c=s("e597"),o=s("c151"),u=s("2677"),l={name:"ProductEdit",components:{Dropdown:r["a"],PictureInput:c["a"]},data:function(){return{selectedProduct:null,imageInputs:[{distinctNumber:0}],imageLinks:[{distinctNumber:1e3,link:""}],globalVariable:1,dataEraser:{},value:!1,toBeDeletedImage:{},showImageDeleteCondition:!1,distinctNumberGenerator:2}},methods:{deleteCardAction:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var a,n;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(2!=e){s.next=5;break}return a=t.toBeDeletedImage.id,n=!1,s.next=5,Object(o["a"])().delete("product_images/deleteSingleImage/".concat(a)).then(function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(s){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:s.data.status&&"success"==s.data.status&&(t.$q.notify({type:"positive",message:"Image deleted successfully",timeout:2e3}),n=!0);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){var s=e.response.data;t.$q.notify({type:"negative",message:s.message,timeout:2e3})}));case 5:if(!n){s.next=8;break}return s.next=8,t.fetchCurrentProduct();case 8:t.showImageDeleteCondition=!1;case 9:case"end":return s.stop()}}),s)})))()},removeImageClicked:function(e){this.toBeDeletedImage=e,this.showImageDeleteCondition=!0},fetchCurrentProduct:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=e.selectedProduct.id,t.next=3,e.$store.dispatch("fetchCurrentProduct",s);case 3:e.setSelectedProduct();case 4:case"end":return t.stop()}}),t)})))()},setSelectedProduct:function(){var e=JSON.parse(JSON.stringify(this.currentProduct));this.selectedProduct=e,window.scrollTo(0,0)},addImageInput:function(){this.imageInputs.push({distinctNumber:this.distinctNumberGenerator++})},removeImageInput:function(e){var t=-1;this.imageInputs.forEach((function(s,a){s.distinctNumber==e.distinctNumber&&(t=a)})),-1!==t&&this.imageInputs.splice(t,1)},addImageLink:function(){this.imageLinks.push({distinctNumber:this.distinctNumberGenerator++,link:""})},removeImageLink:function(e){var t=-1;this.imageLinks.forEach((function(s,a){s.distinctNumber==e.distinctNumber&&(t=a)})),-1!==t&&this.imageLinks.splice(t,1)},updateProduct:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,a,n,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s={},a=e.selectedProduct,n=e.currentProduct,a.name!==n.name&&(s.name=a.name),a.description!==n.description&&(s.description=a.description),a.price!==n.price&&(s.price=a.price),a.stock!==n.stock&&(s.stock=a.stock),a.newCategory&&a.newCategory.id&&(s.category_id=a.newCategory.id),a.newBrand&&a.newBrand.id&&(s.brand_id=a.newBrand.id),a.newModel&&a.newModel.id&&(s.model_id=a.newModel.id),t.next=12,Object(o["a"])().put("products/editProduct/".concat(a.id),s).then(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(s){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s.data.status&&"success"==s.data.status&&e.$q.notify({type:"positive",message:s.data.message,timeout:2e3});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){var s=t.response.data;e.$q.notify({type:"negative",message:s.message,timeout:2e3})}));case 12:if(r=[],e.imageInputs.forEach((function(e){e.image_url&&e.image_url.length>0&&r.push(e.image_url)})),e.imageLinks.forEach((function(e){e.link&&e.link.length>0&&r.push(e.link)})),!(r.length>0)){t.next=18;break}return t.next=18,Object(o["a"])().post("product_images/insertImage/".concat(a.id),{img:r}).then(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(s){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s.data.status&&"success"==s.data.status&&e.$q.notify({type:"positive",message:s.data.message,timeout:2e3});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){var s=t.response.data;e.$q.notify({type:"negative",message:s.message,timeout:2e3})}));case 18:return t.next=20,e.fetchCurrentProduct();case 20:case"end":return t.stop()}}),t)})))()},clearAllData:function(){},restoreDeletedImages:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s=e.selectedProduct.id,a=!1,t.next=4,Object(o["a"])().put("product_images/restoreDeletedImages/".concat(s)).then(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(s){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:s.data.status&&"success"==s.data.status&&(e.$q.notify({type:"positive",message:"Images restored successfully",timeout:2e3}),a=!0);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){var s=t.response.data;e.$q.notify({type:"negative",message:s.message,timeout:2e3})}));case 4:if(!a){t.next=7;break}return t.next=7,e.fetchCurrentProduct();case 7:case"end":return t.stop()}}),t)})))()},dropdownInput:function(e,t){this.selectedProduct[t]=e},imageUpload:function(e,t){var s=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var n,i,r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=-1,s.imageInputs.forEach((function(e,s){e.distinctNumber==t.distinctNumber&&(n=s)})),i=new FormData,i.append("file",e),a.next=6,Object(u["a"])(i);case 6:r=a.sent,r.status&&"success"==r.status&&-1!==n&&(s.imageInputs[n].image_url=r.link);case 8:case"end":return a.stop()}}),a)})))()}},created:function(){this.setSelectedProduct()},computed:{currentProduct:function(){return this.$store.getters.getSelectedProduct},availableCategories:function(){return this.$store.getters.getCategories},availableBrands:function(){return this.$store.getters.getBrands},availableModels:function(){return this.$store.getters.getModels}}},d=l,m=s("2877"),p=Object(m["a"])(d,a,n,!1,null,"1962f47e",null);t["default"]=p.exports}}]);
//# sourceMappingURL=chunk-2d226587.e1200d0d.js.map